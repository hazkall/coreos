variant: fcos
version: 1.4.0
storage:
  files:
    # YUM repository for cri-o
    - path: /etc/yum.repos.d/devel:kubic:libcontainers:stable.repo
      mode: 0644
      overwrite: true
      contents:
        inline: |
          [devel_kubic_libcontainers_stable]
          name=Stable Releases of Upstream github.com/containers packages (Fedora_36)
          type=rpm-md
          baseurl=https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/Fedora_36/
          gpgcheck=1
          gpgkey=https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/Fedora_36/repodata/repomd.xml.key
          enabled=1
    # YUM repository for cri-o
    - path: /etc/yum.repos.d/devel:kubic:libcontainers:stable:cri-o:1.25.repo
      mode: 0644
      overwrite: true
      contents:
        inline: |
          [devel_kubic_libcontainers_stable_cri-o_1.25]
          name=devel:kubic:libcontainers:stable:cri-o:1.25 (Fedora_36)
          type=rpm-md
          baseurl=https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable:/cri-o:/1.25/Fedora_36/
          gpgcheck=1
          gpgkey=https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable:/cri-o:/1.25/Fedora_36/repodata/repomd.xml.key
          enabled=1
    # YUM repository for kubeadm, kubelet and kubectl
    - path: /etc/yum.repos.d/kubernetes.repo
      mode: 0644
      overwrite: true
      contents:
        inline: |
          [kubernetes]
          name=Kubernetes
          baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-$basearch
          enabled=1
          gpgcheck=1
          gpgkey=https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
          exclude=kubelet kubeadm kubectl
 
    # configuring automatic loading of br_netfilter on startup
    - path: /etc/modules-load.d/crio.conf
      mode: 0644
      overwrite: true
      contents:
        inline: |
          br_netfilter
          overlay
    # setting kernel parameters required by kubelet
    - path: /etc/sysctl.d/99-kubernetes-cri.conf
      mode: 0644
      overwrite: true
      contents:
        inline: |
          net.bridge.bridge-nf-call-iptables  = 1
          net.ipv4.ip_forward                 = 1
          net.bridge.bridge-nf-call-ip6tables = 1
passwd: # setting login credentials
  users:
    - name: core
      groups:
        - sudo
        - wheel
      ssh_authorized_keys:
        - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMABwIDFfdiUNdcxuykWeerVEiCIjzw/A8ZBz7HL+Ar7 core